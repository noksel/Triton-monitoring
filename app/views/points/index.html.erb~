<h1>Listing points</h1>
<div id="placeholder" style="width:900px;height:450px;"></div>
<script type="text/javascript">

$(function () {



<%i=1%>
<% Channel.all.each do |chan|%>
var d<%=i%>=[];

<% @points.each do |point| %>
<%if (point.channel==chan)%>
<% #add 14400 ~ +4hours local time%>
d<%=i%>.push([<%=(point.x.to_f*1000+14400000)%>,<%= point.y %>]);
<%end%>
<% end %>
<%i=i+1%>
<%end%>

<%i=1%>
 var placeholder = $("#placeholder");
var plot = $.plot($("#placeholder"), [ 
<% Channel.all.each do |chan|%>
<%if chan.enabled %>
{data: d<%=i%>,label: "<%=chan.channelName%>: <%=Point.where('triton_session_id=? AND channel_id=?',@triton_session.id,chan.id).last.y if Point.where('triton_session_id=? AND channel_id=?',@triton_session.id,chan.id).last %> Ðš" },
<%end%>
<%i=i+1%>
<%end%> ],
{xaxis: { mode: 'time'},

yaxis: {  },
 legend: { noColumns: 3 },
zoom: {interactive: true},
pan: {interactive: true}
});





    // and add panning buttons
    
  


});
</script>

<table>
  <tr>
    <th>X</th>
    <th>Y</th>
		<th>Triton Session ID</th>
		<th>Channel ID</th>
    <th></th>
    <th></th>
    <th></th>
  </tr>
<%@points.reverse!%>
<% @points.each do |point| %>
  <tr>
    <td><%= point.x %></td>
    <td><%= point.y %></td>
		
<td><%= point.triton_session_id %></td>
<td><%= point.channel_id%></td>
    <td><%= link_to 'Show', point %></td>
<%if signed_in?%>
    <td><%= link_to 'Edit', edit_point_path(point) %></td>
    <td><%= link_to 'Destroy', point, method: :delete, data: { confirm: 'Are you sure?' } %></td>
<%end%>
  </tr>
<% end %>
</table>

<br />
<%if signed_in?%>
<%= link_to 'New Point', new_point_path %>
<%end%>
